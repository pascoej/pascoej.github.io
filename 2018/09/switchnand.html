<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Nintendo Switch NAND Upgrade</title>
        <link href="/style.css" rel="stylesheet" type="text/css">
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-51684324-2"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
    
          gtag('config', 'UA-51684324-2');
        </script>
    </head>
    <body>
        <h2>Nintendo Switch NAND Upgrade</h2>
        <p><b>Exciting news:</b> "bnstemp" has performed the first 128GB Switch
        NAND upgrade. They have also posted a <a href="http://bbs.duowan.com/forum.php?mod=viewthread&tid=46505080&from=singlemessage">guide</a> in Chinese</p>
        <p>
          Last month I went to Shenzhen and had my iPhone's NAND upgraded.
          Whenever I found out this was possible I was so amazed that it just
          works, given flashing some data on the new NAND chip. So I wanted to
          try this on another device I own. The Nintendo Switch uses eMMC for
          memory in a very standard package, so I gave giving it an upgrade a
          try.
        </p>
        <h3> Required Materials </h3>
        <ul class="bulleted">
          <li>A Nintendo Switch</li>
          <li>A new eMMC</li>
            <p>
            I personally used a SDINBDG4-64G-XI1 because I could find it on Arrow
            with free overnight shipping. However I'd reccomend trying to buy a
            128GB chip from Taobao, especially if you live in China as it's much
            cheaper. For example you can get a
            <a href="https://item.taobao.com/item.htm?spm=a230r.1.14.18.5b015f78Idmel0&id=572704664660&ns=1&abbucket=14#detail">KLMDGAGEAC-B001</a>
            for only ~20 USD. I have also seen a 256GB eMMC by Samsung KLMEG8UCTA-B041, but
            haven't found a way to purchase it. If somebody finds a way to source 256GB eMMCs,
            please let me know.
            </p>
          <li><a href="https://github.com/CTCaer/hekate">Hekate by CTCaer</a></li>
          <p>
            An amazing tool by CTCaer that's needed to backup your original NAND.
            You need to remove a check to restore a backup onto a larger nand.
            I did this on my <a href="https://github.com/pascoej/hekate">fork</a>,
            you can download a binary <a href="no-backup-sizecheck-hekate.bin">here</a>.
          </p>
          <li>Some sort of linux machine to use gparted, parted, etc</li>
          <li><a href="https://switchtools.sshnuke.net">memloader by rajkosto</a></li>
          <li><a href="https://switchtools.sshnuke.net">biskeydump by rajkosto</a></li>
          <li><a href="https://switchtools.sshnuke.net">HacDiskMount by rajkosto</a></li>
          <li>Hot air rework station, possibly an BGA169 stencil, flux, etc</li>
          <p>
            My SDINBDG4-64G-XI1 came with solder balls already on it and
            first install attempt was successful, but you may need a stencil
            to retry if things don't go quite right.
          </p>
        </ul>
        <p>
          First you need to boot into Hekate using your preferred method and backup
          your BOOT0, BOOT1, and make a full backup. This is critical.
        </p>
          Then dissassemble your switch and remove the eMMC board that looks like
          this.
          <br/>
          <img src="emmc_board.jpg"/>
        <p>
        <p>
          <img src="workstation.jpg"/>
          <br/>
          Then use hot air rework station to remove the original NAND chip and
          clean off the pads on the motherboard.
          <br/>
          <img src="oldchip.jpg"/>
          <br/>
          Old NAND chip after being removed.
        </p>
        <p>
          Then put on your replacement NAND chip. For me this was as easy as putting
          down some flux, lining the new chip up and applying hot air as the replacement
          chip came with solder balls pre installed. At this point you should use Hekate
          console info to verify your switch is seeing the new eMMC correctly.
          <br/>
          <img src="emmc_screen.jpg"/>
        </p>
        <p>
          Then you can use modified Hekate to restore BOOT0, BOOT1, and the full
          backup. At this point your switch should boot up like normal again. It's
          very possible that Nintendo phones home with information about the NAND
          and your console could be banned. However, this has not happened to me yet
        </p>
        <p>
          In order to get the switch to see the full size of the new NAND, you
          have to resize the USER partition. Since the Switch uses encryption on
          this parition it's a little tricky, but with the great tools by the
          community, it's possible. The method I used is using memloader to expose
          the eMMC to a computer. First use biskeydump to dump all your bis keys.
          Then use HacDiskMount and mount the USER partition with bis key 3 and
          make a backup of everything on it.
        </p>
        <p>
          Then use linux tools to recreate the USER partition larger.
          When you open gparted with the eMMC exposed via memloader, it prompts
          you to repair the GPT since it's too small for the device, do this. Then
          use
          <a href="https://falstaff.agner.ch/2013/12/22/online-resize-root-filesystem-on-a-gpt-partition/">gdisk to delete and recreate the USER partition</a>, making sure to set
          maintain the GUID of the partition. This is important because otherwise
          the switch will not boot after. It's likely it uses the GUID to mount
          the USER partition. I also reset the partition type back to 0xFFFF with parted after this.
        </p>
        <p>
          Then go back to a Windows computer and again expose the eMMC with memloader.
          Use HacDiskMount, ignore the warning about not being a full NAND dump,
          and mount the USER partition using the same BIS keys as before. Then
          format the mounted drive using <a href="http://www.ridgecrop.demon.co.uk/guiformat.htm">guiformat</a>.
          Then copy all the files you backed up from the original partition and
          your switch should be ready to boot with the new expanded memory.
          <br/>
          <img src="result.jpg"/>
        </p>
        <p>
          <a href="/">‚Üê back</a>
        </p>
    </body>
</html>
